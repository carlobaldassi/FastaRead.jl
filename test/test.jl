using FastaRead

function test_fastaread()
    fr = FastaReader(joinpath(dirname(Base.source_path()), "test.fasta.gz"))

    out = {
        ("C0Z3L5_CAEEL/75-127",
         [0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x73,0x2d,0x43,0x54,0x4c,0x50,0x52,
          0x2e,0x2e,0x2e,0x51,0x49,0x47,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x54,0x2e,0x2e,0x2e,0x47,0x50,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x59,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x52,0x49,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x50,0x52,0x57,0x2e,0x2e,0x59,0x59,0x4e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x50,0x56,0x52,0x47,0x52,0x43,0x45,0x2e,0x2e,0x2e,
          0x4c,0x46,0x2e,0x2e,0x59,0x2e,0x57,0x2e,0x2e,0x2e,
          0x53,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x47,0x2e,
          0x43,0x2e,0x2e,0x2e,0x43,0x2e,0x47,0x2e,0x2e,0x2e,
          0x4e,0x2e,0x2e,0x2e,0x47,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x4e,0x4e,0x46,0x51,0x54,0x46,0x51,0x54,
          0x2e,0x2e,0x2e,0x2e,0x43,0x51,0x53,0x54,0x43,0x2d,
          0x65,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e]),
        ("A8X0E5_CAEBR/76-128",
         [0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x73,0x2d,0x43,0x54,0x4c,0x50,0x52,
          0x2e,0x2e,0x2e,0x51,0x49,0x47,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x54,0x2e,0x2e,0x2e,0x47,0x50,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x59,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x52,0x49,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x50,0x52,0x57,0x2e,0x2e,0x59,0x59,0x4e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x50,0x56,0x52,0x47,0x52,0x43,0x45,0x2e,0x2e,0x2e,
          0x4c,0x46,0x2e,0x2e,0x59,0x2e,0x57,0x2e,0x2e,0x2e,
          0x53,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x47,0x2e,
          0x43,0x2e,0x2e,0x2e,0x43,0x2e,0x47,0x2e,0x2e,0x2e,
          0x4e,0x2e,0x2e,0x2e,0x47,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x4e,0x4e,0x46,0x51,0x54,0x46,0x51,0x54,
          0x2e,0x2e,0x2e,0x2e,0x43,0x51,0x53,0x54,0x43,0x2d,
          0x65,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e]),
        ("C0Z3L4_CAEEL/75-127",
         [0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x73,0x2d,0x43,0x54,0x4c,0x50,0x52,
          0x2e,0x2e,0x2e,0x51,0x49,0x47,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x54,0x2e,0x2e,0x2e,0x47,0x50,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x59,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x52,0x49,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x50,0x52,0x57,0x2e,0x2e,0x59,0x59,0x4e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x50,0x56,0x52,0x47,0x52,0x43,0x45,0x2e,0x2e,0x2e,
          0x4c,0x46,0x2e,0x2e,0x59,0x2e,0x57,0x2e,0x2e,0x2e,
          0x53,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x47,0x2e,
          0x43,0x2e,0x2e,0x2e,0x43,0x2e,0x47,0x2e,0x2e,0x2e,
          0x4e,0x2e,0x2e,0x2e,0x47,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x4e,0x4e,0x46,0x51,0x54,0x46,0x51,0x54,
          0x2e,0x2e,0x2e,0x2e,0x43,0x51,0x53,0x54,0x43,0x2d,
          0x65,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e]),
        ("Q9XWX5_CAEEL/75-127",
         [0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x73,0x2d,0x43,0x54,0x4c,0x50,0x52,
          0x2e,0x2e,0x2e,0x51,0x49,0x47,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x54,0x2e,0x2e,0x2e,0x47,0x50,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x59,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x52,0x49,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x50,0x52,0x57,0x2e,0x2e,0x59,0x59,0x4e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x50,0x56,0x52,0x47,0x52,0x43,0x45,0x2e,0x2e,0x2e,
          0x4c,0x46,0x2e,0x2e,0x59,0x2e,0x57,0x2e,0x2e,0x2e,
          0x53,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x47,0x2e,
          0x43,0x2e,0x2e,0x2e,0x43,0x2e,0x47,0x2e,0x2e,0x2e,
          0x4e,0x2e,0x2e,0x2e,0x47,0x2e,0x2e,0x2e,0x2e,0x2e,
          0x2e,0x2e,0x4e,0x4e,0x46,0x51,0x54,0x46,0x51,0x54,
          0x2e,0x2e,0x2e,0x2e,0x43,0x51,0x53,0x54,0x43,0x2d,
          0x65,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e,0x2e])
         }

    Test.@test readall(fr) == out

    rewind(fr)

    n = 0
    for (name, seq) in fr
        n += 1
        Test.@test name == out[n][1]
        Test.@test seq == out[n][2]
    end

    close(fr)
end

test_fastaread()
